<?xml version="1.0"?>

<!DOCTYPE overlay [
<!ENTITY % tabmixDTD SYSTEM "chrome://tabmixplus/locale/tabmix.dtd" >
%tabmixDTD;
<!ENTITY % browserDTD SYSTEM "chrome://browser/locale/browser.dtd" >
%browserDTD;
]>

<overlay id="tabmix-tabContextMenu-overlay"
   xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul">

  <popupset id="mainPopupSet">
    <menupopup id="tabContextMenu">
        <menuitem id="context_openANewTab" insertbefore="context_reloadTab"
                 label="&tabCmd.label;" _afterthis="(&afterthis.label;)" _newtab="&tabCmd.label;"
                 tmp_iconic="menuitem-iconic tabmix-newtab-menu-icon menuitem-with-favicon"
                 oncommand="BrowserOpenTab();"/>
        <menuitem id="tm-duplicateinWin" insertafter="context_duplicateTabs"
                 label="&duplicateinWin.label;" accesskey="&duplicateinWin.accesskey;"
                 oncommand="gBrowser.duplicateTabsToWindow(TabContextMenu.contextTab);"/>
<!--
        <menuitem id="context_reloadTab">
        <menuitem id="context_reloadSelectedTabs">
        <menuitem id="context_toggleMuteTab">
        <menuitem id="context_toggleMuteSelectedTabs">
        <menuitem id="context_pinTab">
        <menuitem id="context_unpinTab"/>
        <menuitem id="context_pinSelectedTabs"/>
        <menuitem id="context_unpinSelectedTabs"/>
        <menuitem id="context_duplicateTab"/>
        <menuitem id="context_duplicateTabs"/>
        <menuseparator/>
        <menuitem id="context_selectAllTabs"/>
        <menuitem id="context_bookmarkSelectedTabs"/>
        <menuitem id="context_bookmarkTab"/>
-->

        <menuitem id="tm-mergeWindowsTab" insertbefore="context_reopenInContainer"
                 key="key_tm_mergeWin" label="&mergeContext.label;" accesskey="&mergeContext.accesskey;"
                 oncommand="Tabmix.MergeWindows.mergeWindows(window);"/>
        <menuitem id="tm-renameTab" insertbefore="context_reopenInContainer"
                 label="&renametab.label;" accesskey="&renametab.accesskey;"
                 oncommand="Tabmix.renameTab.editTitle(TabContextMenu.contextTab);"/>
        <menuitem id="tm-copyTabUrl" insertbefore="context_reopenInContainer"
                 label="&copytaburl.label;" accesskey="&copytaburl.accesskey;"
                 oncommand="gBrowser.copyTabUrl(TabContextMenu.contextTab);"/>
<!--
        <menu id="context_reopenInContainer"/>
        <menu id="context_moveTabOptions">
          <menupopup id="moveTabOptionsMenu">
            <menuitem id="context_moveToStart"/>
            <menuitem id="context_moveToEnd"/>
            <menuitem id="context_openTabInWindow"/>
          </menupopup>
        </menu>
        <menu id="context_sendTabToDevice"/>
        <menuseparator>

        TabmixContext.buildTabContextMenu move context_reloadTab to this location
        <menuitem id="context_reloadTab"/>
-->
        <menu id="tm-autoreloadTab_menu" insertbefore="context_closeTabOptions"
              labelTab="&autoReloadTab.label;" accesskeyTab="&autoReloadTab.accesskey;"
              labelSite="&autoReloadSite.label;" accesskeySite="&autoReloadSite.accesskey;">
           <menupopup onpopupshowing="Tabmix.autoReload.onPopupShowing(this, TabContextMenu.contextTab);"/>
        </menu>
        <menu id="context_reloadTabOptions" insertbefore="context_closeTabOptions"
            label="&reloadmultiple.label;" accesskey="&reloadmultiple.accesskey;">
          <menupopup id="reloadTabOptions">
            <!-- add menu item to reload selected tabs -->
            <menuitem id="tm-reloadLeft"
                    label="&reloadleft.label;" accesskey="&reloadleft.accesskey;"
                    oncommand="gBrowser._reloadLeftTabs(TabContextMenu.contextTab);"/>
            <menuitem id="tm-reloadRight"
                    label="&reloadright.label;" accesskey="&reloadright.accesskey;"
                    oncommand="gBrowser._reloadRightTabs(TabContextMenu.contextTab);" />
            <menuitem id="context_reloadAllTabs"
                    data-lazy-l10n-id="content-blocking-reload-tabs-button"
                    oncommand="Tabmix.tablib.reloadTabs(Tabmix.visibleTabs.tabs);"/>
            <menuitem id="tm-reloadOther"
                    label="&reloadother.label;" accesskey="&reloadother.accesskey;"
                    oncommand="gBrowser.reloadAllTabsBut(TabContextMenu.contextTab);" />
          </menupopup>
        </menu>
        <menuseparator id="tabmix_reloadTabOptions_separator" insertbefore="context_closeTabOptions" type="tabmix"/>

        <menu id="tm-undoCloseList" insertbefore="context_closeTabOptions"
                 tmp_iconic="menu-iconic closedtabs-icon"
                 label="&undoCloseListMenu.label;" accesskey="&undoCloseListMenu.accesskey;">
          <menupopup id="tm-undoCloseList-menu"
            onpopupshowing="Tabmix.closedObjectsUtils.populateClosedTabsMenu(this.parentNode); event.stopPropagation();"
            onpopupshown="event.stopPropagation();"
            onpopuphidden="TabmixAllTabs.hideCommonList(this);"/>
        </menu>
<!--
        Before Firefox 88 context_closeTab positioned after context_undoCloseTab
        <menuitem id="context_closeTab"/>
        <menu id="context_closeTabOptions">
          <menupopup id="closeTabOptions">
            <menuitem id="context_closeTabsToTheStart"/>
            <menuitem id="context_closeTabsToTheEnd"/>
            <menuitem id="context_closeOtherTabs"/>
          </menupopup>
        </menu>
-->
        <menuitem id="tm-closeAllTabs" insertbefore="context_closeOtherTabs"
                 label="&closeAllTabsMenu.label;" accesskey="&closeall.accesskey;"
                 oncommand="gBrowser.closeAllTabs();"/>
        <menuitem id="tm-closeSimilar" insertbefore="context_closeOtherTabs"
                 label="&closeSimilarTab.label;" accesskey="&closeSimilarTab.accesskey;"
                 oncommand="gBrowser.closeGroupTabs(TabContextMenu.contextTab);"/>
        <menuitem id="context_undoCloseTab" oncommand="TMP_ClosedTabs.undoCloseTab();"/>

        <menuseparator id="tabmix_closeTab_separator" insertbefore="context_undoCloseTab" type="tabmix"/>
        <menu id="tm-docShell" insertbefore="context_undoCloseTab"
                label="&docShellMenu.label;" accesskey="&docShellMenu.accesskey;">
         <menupopup
                onpopupshowing="Tabmix.docShellCapabilities.onGet(this.childNodes, TabContextMenu.contextTab);
                                event.stopPropagation();"
                onpopupshown="event.stopPropagation();"
                oncommand="Tabmix.docShellCapabilities.onSet(TabContextMenu.contextTab,event.originalTarget);">
           <menuitem label="&allowImage.label;" value="Images" class="menuitem-iconic" type="checkbox" checked="true" />
           <menuitem label="&allowFrame.label;" value="Subframes" class="menuitem-iconic" type="checkbox" checked="true" />
           <menuitem label="&allowRedirect.label;" value="MetaRedirects" class="menuitem-iconic" type="checkbox" checked="true" />
           <menuitem label="&allowPlugin.label;" value="Plugins" class="menuitem-iconic" type="checkbox" checked="true" />
           <menuitem label="&allowJavascript.label;" value="Javascript" class="menuitem-iconic" type="checkbox" checked="true" />
         </menupopup>
        </menu>
        <menuitem id="tm-freezeTab" insertbefore="context_undoCloseTab"
                 label="&freezeTabMenu.label;" accesskey="&freezeTabMenu.accesskey;" type="checkbox"
                 oncommand="gBrowser.freezeTab(TabContextMenu.contextTab);" />
        <menuitem id="tm-protectTab" insertbefore="context_undoCloseTab"
                 label="&protectTabMenu.label;" accesskey="&protectTabMenu.accesskey;" type="checkbox"
                 oncommand="gBrowser.protectTab(TabContextMenu.contextTab);"/>
        <menuitem id="tm-lockTab" insertbefore="context_undoCloseTab"
                 label="&lockTabMenu.label;" accesskey="&lockTabMenu.accesskey;" type="checkbox"
                 oncommand="gBrowser.lockTab(TabContextMenu.contextTab);"/>
        <menuseparator id="tabmix_lockTab_separator" insertbefore="context_undoCloseTab" type="tabmix"/>

<!--
        TabmixContext.buildTabContextMenu
        move context_bookmarkSelectedTabs and context_bookmarkTab to this location
-->
        <menuitem id="context_bookmarkAllTabs"
                  command="Browser:BookmarkAllTabs"
                  data-lazy-l10n-id="menu-bookmarks-all-tabs"/>

    </menupopup>
  </popupset>

</overlay>
